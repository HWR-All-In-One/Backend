name: Makefile CI

on:
  #push:
  #  branches: [ "main", "dev", "feature/HAIO-96/CI_CD_einrichten_BE-2" ]
  #  tags:
  #    - 'v*'
  pull_request:
    branches: [ "main", "dev", "feature/HAIO-96/CI_CD_einrichten_BE-2", "feature/HAIO-96/CI_CD_einrichten_BE-2_Test" ]
    types: [closed]

jobs:    
  build-Docker:
    runs-on: ubuntu-latest

    if: github.event.pull_request.merged

    steps:
      - 
        name: Branchname
        run: |
          echo "GIT_SHA=${GITHUB_SHA}" >> $GITHUB_ENV
          echo "GIT_BRANCH=${GITHUB_REF##*/}" >> $GITHUB_ENV
          echo HEAD_REF: $GITHUB_HEAD_REF
          echo BASE_REF: $GITHUB_BASE_REF
        # example for $GITHUB_HEAD_REF and $GITHUB_BASE_REF:
        # When you merge from "feature/HAIO-96/CI_CD_einrichten_BE-2" to "feature/HAIO-96/CI_CD_einrichten_BE-2_Test"
        # HEAD_REF: feature/HAIO-96/CI_CD_einrichten_BE-2
        # BASE_REF: feature/HAIO-96/CI_CD_einrichten_BE-2_Test
      - 
        uses: haya14busa/action-cond@v1
        id: condTargetIsDev
        with:
          cond: ${{ github.base_ref == 'feature/HAIO-96/CI_CD_einrichten_BE-2_Test' }}
          if_true: "true"
          if_false: "false"
      - 
        uses: haya14busa/action-cond@v1
        id: condTargetIsMain
        with:
          cond: ${{ github.base_ref == 'main' }}
          if_true: "true"
          if_false: "false"
      - 
        uses: haya14busa/action-cond@v1
        id: condSourceIsFeature
        with:
          cond: ${{ startsWith( GITHUB_HEAD_REF, 'feature' }}
          if_true: "true"
          if_false: "false"
      - 
        uses: haya14busa/action-cond@v1
        id: condSourceIsSubeature
        with:
          cond: ${{ startsWith( GITHUB_HEAD_REF, 'subfeature' }}
          if_true: "true"
          if_false: "false"
      - 
        uses: haya14busa/action-cond@v1
        id: condSourceIsBug
        with:
          cond: ${{ startsWith( GITHUB_HEAD_REF, 'feature' }}
          if_true: "true"
          if_false: "false"
      - 
        name: Use conditional value
        run: echo "${{ steps.condTargetIsDev.outputs.value }}"
      
      - 
        name: Versiontag-dev
        if: ${{ github.base_ref == 'feature/HAIO-96/CI_CD_einrichten_BE-2_Test' }}
        run: |
          echo "Hi, ich bin es"
      -
        name: Checkout
        uses: actions/checkout@v3